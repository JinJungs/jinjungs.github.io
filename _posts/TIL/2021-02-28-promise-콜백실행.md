---
title: "210228_promiseë¡œ ì½œë°±ì§€ì˜¥ íƒˆì¶œí•˜ê¸°"
date: 2021-02-28 23:22:28 -0900
categories: til javascript
---

### ì˜¤ëŠ˜ í•œ ì¼

- ëŒ€í™”ìƒëŒ€ ì¶”ê°€ í˜ì´ì§€ í”„ë¡ íŠ¸ë¥¼ ìˆ˜ì •í–ˆë‹¤.
  - ì‚¬ëŒì„ ì¶”ê°€í•˜ë©´ì„œ headë¶€ë¶„ì´ ëŠ˜ì–´ë‚˜ëŠ”ë°, ë¬¸ì œëŠ” bodyë¶€ë¶„ì´ footerì— ê°€ë ¤ì„œ ì•ˆë³´ì´ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤...
  - ì´ë¦¬ì €ë¦¬ í—¤ë§¤ë‹¤ê°€ ì±„íŒ…ìª½ ì½”ë“œë¥¼ ë³´ê³  `row`ì™€ `col`ë¡œ ì§œë†“ì€ ì½”ë“œ ëŒ€ì‹ ì— `card-header`, `card-body`, `card-footer`ë¡œ ë‚˜ëˆ„ë‹ˆê¹Œ í•´ê²°ë˜ì—ˆë‹¤.

- Promiseë¡œ ì½œë°±ì§€ì˜¥ ì½”ë“œ ì •ë¦¬í•˜ê¸°

  - ë“œë¦¼ì½”ë”© ì—˜ë¦¬ë‹˜ì˜ ê°•ì˜ë¥¼ ë³´ë©´ì„œ ê°œë…ì„ ì •ë¦¬í•˜ê³  ìˆë‹¤. ì •ë§ ë¹›ê°™ì€ ê°•ì˜ë‹¤ã… ã… 

  - ì˜¤ëŠ˜ì€ ê°œë…ë§Œ ì´í•´í•˜ê³  ë‚´ì¼ ë‹¤ì‹œ ì½”ë“œë¥¼ ì •ë¦¬í•˜ì!

  

### ì½œë°±ì§€ì˜¥

ë‚´ê°€ ì§  ì½”ë“œê°€ ë°”ë¡œ ì½œë°±ì§€ì˜¥ì¸ê°€ ë³´ë‹¤ğŸ¤£ğŸ¤£

```jsx
$(document).ready(function () {
    console.log("ê¸°ì¡´ ë©¤ë²„ ìˆ˜ : " + existingMemberNum);
    // ajaxë¡œ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
    searchAjax("");
    <c:forEach var="i" items="${partyList}">
        addExistingMembers(${i.emp_code}, "${i.empname}");
        disableCheckbox(${i.emp_code}) // ì²´í¬ë°•ìŠ¤ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ë„ë¡ ìƒíƒœë¥¼ disabledë¡œ ìˆ˜ì •
    </c:forEach>
});
```

`searchAjax()` -> `addExistingMembers(code, name)` -> `disableCheckbox(code)` ìˆœìœ¼ë¡œ ì‹¤í–‰í•˜ê³  ì‹¶ì—ˆëŠ”ë°, ìˆœì„œê°€ ê¼¬ì—¬ì„œ ë’¤ì— ë‘ í•¨ìˆ˜ê°€ ì œëŒ€ë¡œ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ë‹¤.



### Promiseë¡œ ì½œë°±í•¨ìˆ˜ ì‹¤í–‰í•˜ê¸°

ì‚¬ì „ë“±ë¡ì„ í•´ë†“ìœ¼ë©´, ì‚¬ì´íŠ¸ê°€ ì˜¤í”ˆëœ í›„ì— ìë™ìœ¼ë¡œ ì´ˆëŒ€ì´ë©”ì¼ì´ ë°œì†¡ë˜ëŠ” í”„ë¡œê·¸ë¨ì´ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì. ì² ìˆ˜ëŠ” ì‚¬ì´íŠ¸ ì˜¤í”ˆ ì „ì— ì‚¬ì „ë“±ë¡ì„ í•´ë‘ì–´ì„œ, ì˜¤í”ˆ í›„ ì´ˆëŒ€ë©”ì¼ì„ ë°›ê²Œ ë˜ì—ˆë‹¤. ì˜í¬ëŠ” ì‚¬ì´íŠ¸ê°€ ì´ë¯¸ ì˜¤í”ˆëœ í›„ì—ì•¼ ì‚¬ì „ë“±ë¡ì„ í–ˆëŠ”ë°, ì´ë¯¸ ì‚¬ì´íŠ¸ê°€ ì˜¤í”ˆëœ í›„ì´ê¸° ë•Œë¬¸ì— ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë°”ë¡œ ë©”ì¼ì„ ë°›ì„ ìˆ˜ ìˆì—ˆë‹¤.

PromiseëŠ” ë¹„ë™ê¸°ë¥¼ ìˆ˜í–‰í•  ë•Œ ì½œë°±í•¨ìˆ˜ ëŒ€ì‹  ìœ ìš©í•˜ê²Œ ì“¸ ìˆ˜ ìˆëŠ” javascriptì— ë‚´ì¥ëœ objectì´ë‹¤.
ë‘ê°€ì§€ì˜ í•µì‹¬ê°œë…ì„ ì´í•´í•˜ë©´ í¸í•˜ë‹¤.

- **State**
  - pending : Promiseê°€ ë§Œë“¤ì–´ì ¸ì„œ ìš°ë¦¬ê°€ ì§€ì •í•œ operzationì´ ìˆ˜í–‰ì¤‘ì¼ ë•Œ
  - fullfilled : operationì´ ì™„ë£Œëœ ìƒíƒœ
  - rejected: operationì´ ê±°ë¶€ëœ ìƒíƒœ

- **Producer vs Consumer**
  - ProducerëŠ” ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ê³  í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë¥¼ ë§Œë“ ë‹¤.
    - ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ ì‹œ resolveë¥¼ ë°˜í™˜í•œë‹¤.
    - ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°ì—ëŠ” rejectë¥¼ ë°˜í™˜í•˜ê³ , ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ” ì´ìœ ë¥¼ ì ì–´ë‘ëŠ” ê²ƒì´ ì¢‹ë‹¤.
  - ConsumerëŠ” `then`, `catch`, `finally`ë¡œ ê°’ì„ ì²˜ë¦¬í•œë‹¤.
    - then : Promiseê°€ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰í–ˆì„ ê²½ìš° resolve ì½œë°±í•¨ìˆ˜ë¥¼ í†µí•´ ê°’ì„ ì „ë‹¬ë°›ëŠ”ë‹¤.
    - catch : Promiseê°€ ì—ëŸ¬ ë°œìƒ ì‹œ reject ì½œë°±í•¨ìˆ˜ë¥¼ í†µí•´ ê°’ì„ ì „ë‹¬ë°›ëŠ”ë‹¤.
    - finally : ê²°ê³¼ì™€ ìƒê´€ì—†ì´ ë§ˆì§€ë§‰ì— ë¬´ì¡°ê±´ ì‹¤í–‰ëœë‹¤.



1. **Producer**

   - ìƒˆë¡œìš´ í”„ë¡œë¯¸ìŠ¤ê°€ ë§Œë“¤ì–´ì§ˆ ë•Œ, ì „ë‹¬í•œ executorë¼ëŠ” ì½œë°±í•¨ìˆ˜ê°€ ë°”ë¡œ ì‹¤í–‰ëœë‹¤.
   - ë”°ë¼ì„œ ë‚´ë¶€ì— ë¶ˆí•„ìš”í•œ network í†µì‹ ì´ ë°œìƒí•˜ì§€ëŠ” ì•ŠëŠ”ì§€ ìœ ì˜í•  í•„ìš”ê°€ ìˆë‹¤.

   - resolveì™€ rejectë¥¼ ì¸ìë¡œ ë°›ëŠ”ë‹¤.

   ```jsx
   const promise = new Promise((resolve, reject) =>{
       // doing some heavy work (network, read files)
       console.log('doing somethingk...');
       setTimeout(() => {
           resolve('ellie');
           // reject(new Error('no network'));
       },2000);
   });
   ```

2. **Consumers**

   ```jsx
   promise
       .then((value) => { // ì„±ê³µí–ˆì„ ë•Œ ì‹¤í–‰
       	// valueëŠ” resolveì—ì„œ ì „ë‹¬ëœ 'ellie'ë¼ëŠ” ê°’ì´ ë“¤ì–´ì˜¨ë‹¤.
       	console.log(value);
   	}).catch(error => { // ì‹¤íŒ¨í–ˆì„ ë•Œ ì‹¤í–‰
       	console.log(error);
   	}).finally(() => { // ì„±ê³µì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ë§ˆì§€ë§‰ì— ì‹¤í–‰
       	console.log('finally');
   	})
   ```

3. **Promise chaining**

   ```jsx
   const fetchNumber = new Promise((resolve, reject) => {
       // ì„œë²„í†µì‹ ì—ì„œëŠ” setTimeoutì„ ìì£¼ ì“´ë‹¤.
       setTimeout(() => resolve(1), 1000);
   })
   
   fetchNumber
   .then(num => num*2)
   .then(num => num*3)
   .then(num => {
       return new Promise((resolve, reject) => {
       	setTimeout(() => resolve(num - 1), 1000);
   	})
   })
   // thenì€ ê°’ì„ ë°”ë¡œ ì „ë‹¬í•  ìˆ˜ë„ ìˆê³ , promiseë¥¼ ì „ë‹¬í•  ìˆ˜ë„ ìˆë‹¤.
   ```

   <img src="/img/promise.PNG" style="width: 50%;" >

â€‹		

**ì°¸ê³ (1) - ë§¤ê°œë³€ìˆ˜ë¥¼ í•˜ë‚˜ë§Œ ì „ë‹¬í•˜ëŠ” ê²½ìš°**

ë§¤ê°œë³€ìˆ˜ë¥¼ í•˜ë‚˜ë§Œ ì „ë‹¬í•˜ëŠ” ê²½ìš° ìƒëµí•´ë„ ì•Œì•„ì„œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì „ë‹¬í•œë‹¤.

```jsx
// ìƒëµ ì „
getHen()
	.then(hen => getEgg(hen))
	.then(cook => cook(egg))
	.then(meal => console.log(meal));

// ìƒëµ í›„
getHen()
	.then(getEgg)
	.then(cook)
	.then(console.log)
```



**ì°¸ê³ (2) - ìš©êµ­ì“° ì½”ë“œ**

```jsx
function fn_getSearchEmpList(code){
    return new Promise(function (resolve,reject) {
        var tid= setTimeout(function () {
            $.ajax({
                type : "POST",
                url : "/test/getSearchEmpList",
                data :{code:code},
                dataType :"json",
                success : function(data) {
                    // ìˆ˜í–‰í•˜ëŠ” ê¸´ì½”ë“œ ìƒëµ
                    $("#empWrapper"+data.team_code).append(html);
                    resolve(data);
                    $(".allcontainer").attr("class","allcontainer w-100");
                }
            });
        },100)
    });
}

fn_getDeptList().then(fn_getteamlist).then(fn_getemplist);
```



### References

[ë“œë¦¼ì½”ë”© ì—˜ë¦¬ - í”„ë¡œë¯¸ìŠ¤ ê°œë…ë¶€í„° í™œìš©ê¹Œì§€](https://bit.ly/3pWqfY8)

[Promise - ksh4820 ë‹˜ì˜ velog](https://velog.io/@ksh4820/JS-Promise-pl45mmn9)

